{"mappings":"oeACA,IAAAA,EAAAC,EAAA,S,yCAOA,MAAMC,EAAeC,SAASC,eAAe,gBACvCC,EAAgBF,SAASC,eAAe,iBACxCE,EAAYH,SAASC,eAAe,cAEpCG,EAAYJ,SAASC,eAAe,aACpCI,EAAaL,SAASC,eAAe,cACrCK,EAAaN,SAASO,cAAc,kBACpCC,EAAcR,SAASO,cAAc,mBAErCE,EAAcT,SAASC,eAAe,eAEtCS,EAAW,IAAI,EAAAC,EAAAC,oBAwDrB,IAAIC,EAvDJC,OAAOC,YAAa,EACpBD,OAAOE,QAAU,GAIjBZ,EAAUa,QAAU,KAAM,EAAAN,EAAAO,iBAAgBC,EAAAC,KAAMV,GAChDJ,EAAWW,QAAU,KAAM,EAAAN,EAAAO,iBAAgBC,EAAAC,KAAMV,GAGjDL,EAAWY,QAAU,KACnB,EAAAN,EAAAU,SAAQF,EAAAC,MACLE,MAAK,KACJR,OAAOC,YAAa,CAAK,IAE1BQ,OAAMC,IAAA,IAGXhB,EAAYS,QAAU,KACpB,EAAAN,EAAAU,SAAQF,EAAAC,MACLE,MAAK,KACJR,OAAOC,YAAa,CAAK,IAE1BQ,OAAMC,IAAA,IAIXL,EAAAC,KAAKK,oBAAmBC,IAClBA,GAEFpB,EAAWqB,UAAUC,IAAI,UACzBpB,EAAYmB,UAAUE,OAAO,UAC7B9B,EAAa+B,QAAS,EACtB5B,EAAc4B,QAAS,EACvBrB,EAAYsB,UAAY,aAAaL,EAAKM,oBAC1C7B,EAAU2B,QAAS,EACnBhB,OAAOE,SAAU,IAGjBV,EAAWqB,UAAUE,OAAO,UAC5BrB,EAAYmB,UAAUC,IAAI,UAC1B7B,EAAa+B,QAAS,EACtB5B,EAAc4B,QAAS,EACvBrB,EAAYsB,UAAY,GACxB5B,EAAU2B,QAAS,EACnBhB,OAAOE,SAAU,GAEiC,IAA9CF,OAAOmB,SAASC,KAAKC,OAAO,gBAC9BC,QAAQC,IAAIvB,OAAOmB,SAASC,MAC5BpB,OAAOmB,SAASC,KAAO,c,IAS7Bf,EAAAC,KAAKK,oBAAmBa,MAAMZ,IACxBA,GAGFZ,OAAOC,YAAa,EACpBD,OAAOE,QAAUU,EAAKa,IA0BtB1B,GAAc,EAAAhB,EAAA2C,aAAW,EAAA3C,EAAA4C,KAAItB,EAAAuB,GAAI,QAAShB,EAAKa,IAAII,aAAaC,IAC9DR,QAAQC,IAAI,iBAAkBO,EAAIC,OAAO,KAI3ChC,GAAeA,GAAa","sources":["src/js/firebase.js"],"sourcesContent":["// // Import the functions you need from the SDKs you need\nimport { doc } from 'firebase/firestore';\n\nimport { onSnapshot } from 'firebase/firestore';\nimport { signInWithPopup, signOut, GoogleAuthProvider } from 'firebase/auth';\nimport { db, auth } from './global';\n\n//\nconst whenSignedIn = document.getElementById('whenSignedIn');\nconst whenSignedOut = document.getElementById('whenSignedOut');\nconst myLibrary = document.getElementById('libraryBtn');\n\nconst signInBtn = document.getElementById('signInBtn');\nconst signOutBtn = document.getElementById('signOutBtn');\nconst signInIcon = document.querySelector('svg.icon-login');\nconst signOutIcon = document.querySelector('svg.icon-logout');\n\nconst userDetails = document.getElementById('userDetails');\n\nconst provider = new GoogleAuthProvider();\nwindow.userSigned = false;\nwindow.userUid = '';\n\n/// Sign in event handlers\n\nsignInBtn.onclick = () => signInWithPopup(auth, provider);\nsignInIcon.onclick = () => signInWithPopup(auth, provider);\n\n\nsignOutBtn.onclick = () =>\n  signOut(auth)\n    .then(() => {\n      window.userSigned = false;\n    })\n    .catch(error => {\n      // An error happened.\n    });\nsignOutIcon.onclick = () => \n  signOut(auth)\n    .then(() => {\n      window.userSigned = false;\n    })\n    .catch(error => {\n      // An error happened.\n    });\n\nauth.onAuthStateChanged(user => {\n  if (user) {\n    // signed in\n    signInIcon.classList.add('hidden');\n    signOutIcon.classList.remove('hidden');\n    whenSignedIn.hidden = false;\n    whenSignedOut.hidden = true;\n    userDetails.innerHTML = `<h3>Hello ${user.displayName}!</h3>`;\n    myLibrary.hidden = false;\n    window.userUid = true;\n  } else {\n    // not signed in\n    signInIcon.classList.remove('hidden');\n    signOutIcon.classList.add('hidden');\n    whenSignedIn.hidden = true;\n    whenSignedOut.hidden = false;\n    userDetails.innerHTML = '';\n    myLibrary.hidden = true;\n    window.userUid = false;\n\n    if (window.location.href.search('index.html') === -1) {\n      console.log(window.location.href);\n      window.location.href = 'index.html';\n    }\n  }\n});\n\n///// Firestore /////\n\nlet unsubscribe;\n\nauth.onAuthStateChanged(async user => {\n  if (user) {\n    // Database Reference\n\n    window.userSigned = true;\n    window.userUid = user.uid;\n    //testy\n    // let data = await fetchUserDataFromFirestore(window.userUid);\n    // console.log('moje filmy', data);\n    // await updateUserQueueData(window.userUid, 16, true);\n    // await updateUserQueueData(window.userUid, 12, true);\n    // await updateUserQueueData(window.userUid, 14, true);\n    // let data2 = await fetchUserDataFromFirestore(window.userUid);\n    // console.log('moje filmy po dodaniu trzech filmów do kolejki', data2);\n    // await updateUserWatchedData(window.userUid, 12, true);\n    // let data3 = await fetchUserDataFromFirestore(window.userUid);\n    // console.log('dodanie filmu 12 do obejrzenych', data3);\n    // const test1 = await fetchQueueFilmsPerPage(window.userUid, 1, filmsPerPage);\n    // const test2 = await fetchWatchedFilmsPerPage(window.userUid, 1, filmsPerPage);\n    // console.log(test1);\n    // console.log(test2);\n    //testy\n    // await updateUserWatchedData(window.userUid, 12, false);\n    // let data4 = await fetchUserDataFromFirestore(window.userUid);\n    // console.log('usunięcie filmu 12 z obejrzenych', data4);\n    // await updateUserQueueData(window.userUid, 12, false);\n    // let data5 = await fetchUserDataFromFirestore(window.userUid);\n    // console.log('usunięcie filmu 12', data5);\n    // await deleteUserData(window.userUid);\n    //\n\n    unsubscribe = onSnapshot(doc(db, 'films', user.uid.toString()), doc => {\n      console.log('Current data: ', doc.data());\n    });\n  } else {\n    // Unsubscribe when the user signs out\n    unsubscribe && unsubscribe();\n  }\n});\n"],"names":["$ftYLF","parcelRequire","$1ac6e48565c64d78$var$whenSignedIn","document","getElementById","$1ac6e48565c64d78$var$whenSignedOut","$1ac6e48565c64d78$var$myLibrary","$1ac6e48565c64d78$var$signInBtn","$1ac6e48565c64d78$var$signOutBtn","$1ac6e48565c64d78$var$signInIcon","querySelector","$1ac6e48565c64d78$var$signOutIcon","$1ac6e48565c64d78$var$userDetails","$1ac6e48565c64d78$var$provider","$eyjy7","GoogleAuthProvider","$1ac6e48565c64d78$var$unsubscribe","window","userSigned","userUid","onclick","signInWithPopup","$x2zem","auth","signOut","then","catch","error","onAuthStateChanged","user","classList","add","remove","hidden","innerHTML","displayName","location","href","search","console","log","async","uid","onSnapshot","doc","db","toString","doc1","data"],"version":3,"file":"index.b232569e.js.map"}