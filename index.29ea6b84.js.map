{"mappings":"oeAEA,IAAAA,EAAAC,EAAA,S,0BAKsB,MACpB,MAAMC,EAAYC,SAASC,eAAe,cAEpCC,EAAaF,SAASG,cAAc,kBACpCC,EAAcJ,SAASG,cAAc,mBACrCE,EAAcL,SAASG,cAAc,uDAErCG,EAAW,IAAI,EAAAC,EAAAC,oBAyCrB,IAAIC,EAxCJC,OAAOC,YAAa,EACpBD,OAAOE,QAAU,GAIjBV,EAAWW,QAAU,KAAM,EAAAN,EAAAO,iBAAgBC,EAAAC,KAAMV,GAEjDF,EAAYS,QAAU,KACpB,EAAAN,EAAAU,SAAQF,EAAAC,MACLE,MAAK,KACJR,OAAOC,YAAa,CAAK,IAE1BQ,OAAMC,IAAA,IAIXL,EAAAC,KAAKK,oBAAmBC,IAClBA,GAEFpB,EAAWqB,UAAUC,IAAI,UACzBpB,EAAYmB,UAAUE,OAAO,UAC7BpB,EAAYqB,UAAY,SAASJ,EAAKK,eACtC5B,EAAUwB,UAAUE,OAAO,UAC3Bf,OAAOE,SAAU,IAGjBV,EAAWqB,UAAUE,OAAO,UAC5BrB,EAAYmB,UAAUC,IAAI,UAC1BnB,EAAYqB,UAAY,GACxB3B,EAAUwB,UAAUC,IAAI,UACxBd,OAAOE,SAAU,GAEiC,IAA9CF,OAAOkB,SAASC,KAAKC,OAAO,gBAC9BC,QAAQC,IAAItB,OAAOkB,SAASC,MAC5BnB,OAAOkB,SAASC,KAAO,c,IAQ7Bd,EAAAC,KAAKK,oBAAmBY,MAAMX,IACxBA,GAGFZ,OAAOC,YAAa,EACpBD,OAAOE,QAAUU,EAAKY,IAEtBzB,GAAc,EAAAZ,EAAAsC,aAAW,EAAApB,EAAAqB,KAAIrB,EAAAsB,GAAI,QAASf,EAAKY,IAAII,aAAaC,IAC9DR,QAAQC,IAAI,iBAAkBO,EAAIC,OAAO,KAI3C/B,GAAeA,GAAa,GAE9B,EAEJgC","sources":["src/js/firebase.js"],"sourcesContent":["// // Import the functions you need from the SDKs you need\n\nimport { onSnapshot } from 'firebase/firestore';\nimport { signInWithPopup, signOut, GoogleAuthProvider } from 'firebase/auth';\nimport { db, auth, doc } from './global';\n\n//\nconst loginHandling = () => {\n  const myLibrary = document.getElementById('libraryBtn');\n\n  const signInIcon = document.querySelector('svg.icon-login');\n  const signOutIcon = document.querySelector('svg.icon-logout');\n  const userDetails = document.querySelector('p.home-header__greeting, p.library-header__greeting')\n\n  const provider = new GoogleAuthProvider();\n  window.userSigned = false;\n  window.userUid = '';\n\n  /// Sign in event handlers\n\n  signInIcon.onclick = () => signInWithPopup(auth, provider);\n\n  signOutIcon.onclick = () =>\n    signOut(auth)\n      .then(() => {\n        window.userSigned = false;\n      })\n      .catch(error => {\n        // An error happened.\n      });\n\n  auth.onAuthStateChanged(user => {\n    if (user) {\n      // signed in\n      signInIcon.classList.add('hidden');\n      signOutIcon.classList.remove('hidden');\n      userDetails.innerHTML = `Hello ${user.displayName}!`;\n      myLibrary.classList.remove('hidden');\n      window.userUid = true;\n    } else {\n      // not signed in\n      signInIcon.classList.remove('hidden');\n      signOutIcon.classList.add('hidden');\n      userDetails.innerHTML = '';\n      myLibrary.classList.add('hidden');\n      window.userUid = false;\n\n      if (window.location.href.search('index.html') === -1) {\n        console.log(window.location.href);\n        window.location.href = 'index.html';\n      }\n    }\n  });\n  ///// Firestore /////\n\n  let unsubscribe;\n\n  auth.onAuthStateChanged(async user => {\n    if (user) {\n      // Database Reference\n\n      window.userSigned = true;\n      window.userUid = user.uid;\n\n      unsubscribe = onSnapshot(doc(db, 'films', user.uid.toString()), doc => {\n        console.log('Current data: ', doc.data());\n      });\n    } else {\n      // Unsubscribe when the user signs out\n      unsubscribe && unsubscribe();\n    }\n  });\n};\nloginHandling();\n"],"names":["$ftYLF","parcelRequire","myLibrary","document","getElementById","signInIcon","querySelector","signOutIcon","userDetails","provider","$eyjy7","GoogleAuthProvider","unsubscribe","window","userSigned","userUid","onclick","signInWithPopup","$x2zem","auth","signOut","then","catch","error","onAuthStateChanged","user","classList","add","remove","innerHTML","displayName","location","href","search","console","log","async","uid","onSnapshot","doc","db","toString","doc1","data","$1ac6e48565c64d78$var$loginHandling"],"version":3,"file":"index.29ea6b84.js.map"}